name: 定时任务测试

# 触发条件
on:
  # 定时执行 - 每天北京时间9点 (UTC+8，所以写UTC 1点)
  schedule:
    - cron: '0 1 * * *'
  # 手动触发 - 用于测试
  workflow_dispatch:

jobs:
  test-job:
    runs-on: ubuntu-latest
    
    steps:
      # 测试步骤
      - name: 打印测试信息
        run: |
          echo "Hello! 定时任务执行成功！"
          echo "当前时间: $(TZ='Asia/Shanghai' date '+%Y-%m-%d %H:%M:%S')"
      
      # 发送企业微信通知
      - name: 发送企业微信通知
        run: |
          curl -X POST "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${{ secrets.WECHAT_KEY }}" \
            -H "Content-Type: application/json" \
            -d '{
              "msgtype": "text",
              "text": {
                "content": "✅ GitHub Actions 测试成功！\n时间: '"$(TZ='Asia/Shanghai' date '+%Y-%m-%d %H:%M:%S')"'"
              }
            }'
